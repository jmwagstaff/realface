How we trained the network.